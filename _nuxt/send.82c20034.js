import{_ as fe}from"./BaseHeading.vue.da1486f5.js";import{_ as he}from"./BaseParagraph.vue.93f4e84d.js";import{_ as ve}from"./BaseInput.vue.c5dbaf29.js";import{_ as ge}from"./BaseButton.8c2a11c7.js";import{_ as we}from"./BaseButtonClose.vue.3f197406.js";import{_ as _e}from"./TairoModal.vue.15c085a1.js";import{d as ye,P as be,r as a,c as S,z as xe,y as Se,L as H,o as ke,a as Ae,i as s,Q as L,b as c,w as m,j as k,e as g,H as A,t as Ee}from"./entry.8b56785a.js";import{u as Te}from"./toaster.2e70dc60.js";import{z as E,u as De,F as j,t as Ce}from"./vee-validate.esm.71f0b62c.js";import"./index.4e5993e3.js";import{L as Ve}from"./index.77e43e64.js";import"./buttons.4e3c9cb5.js";import"./_plugin-vue_export-helper.c27b6911.js";import"./nuxt-link.ce5a3c72.js";import"./Icon.863bc465.js";import"./index.9bee2a75.js";import"./input-id.61a77fb2.js";import"./use-outside-click.febb87cc.js";import"./transition.388b2c8e.js";const Be={class:"bg-muted-100 dark:bg-muted-900 relative min-h-screen w-full overflow-hidden px-4"},Pe={class:"flex w-full items-center justify-center"},Fe={class:"relative mx-auto w-full max-w-2xl shadow-muted-400 shadow shadow-5xl rounded bg-muted-50 dark:bg-muted-700/70"},Ie={class:"me-auto ms-auto mt-4 w-full"},Ne={class:"text-center"},Me={class:"px-8 py-4"},Oe={class:"mb-4 space-y-4"},Re={class:"space-y-1"},Ue=s("span",null,"Max",-1),qe={class:"mb-2 pl-2"},He={class:"flex items-center justify-between"},Le={class:"text-gray-400 text-sm"},je=s("span",null,[s("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 256 256"},[s("path",{fill:"currentColor",d:"M208 56h-27.72l-13.63-20.44A8 8 0 0 0 160 32H96a8 8 0 0 0-6.65 3.56L75.71 56H48a24 24 0 0 0-24 24v112a24 24 0 0 0 24 24h160a24 24 0 0 0 24-24V80a24 24 0 0 0-24-24m8 136a8 8 0 0 1-8 8H48a8 8 0 0 1-8-8V80a8 8 0 0 1 8-8h32a8 8 0 0 0 6.66-3.56L100.28 48h55.43l13.63 20.44A8 8 0 0 0 176 72h32a8 8 0 0 1 8 8ZM128 88a44 44 0 1 0 44 44a44.05 44.05 0 0 0-44-44m0 72a28 28 0 1 1 28-28a28 28 0 0 1-28 28"})])],-1),ze={class:"mb-6 flex items-center justify-center"},We={class:"px-3"},Qe={class:"flex w-full items-center justify-between p-4 md:p-6"},Je=s("h3",{class:"font-heading text-muted-900 text-lg font-medium leading-6 dark:text-white"}," Enter your Passcode to confirm ",-1),$e=s("div",{class:"p-4 md:p-6"},[s("div",{class:"mx-auto w-full max-w-xs text-center"})],-1),Ge={class:"p-4 md:p-6"},Xe={class:"flex gap-x-2"},Ye={class:"flex w-full items-center justify-between p-4 md:p-6"},Ze=s("h3",{class:"font-heading text-muted-900 text-lg font-medium leading-6 dark:text-white"}," Scan wizard ",-1),Ke=s("p",{class:"text-sm p-2"},"Display the QR image for scanning and initiating a search for a transaction",-1),Vt=ye({__name:"send",setup(et){be();const h=Te(),T=a(!1),D=a(!1);function C(){T.value=!1}function V(){D.value=!1}function z(){T.value=!0}function W(){D.value=!0}const B=new Ve;var y=a(""),n=a(0),p=a("");a(!1);const w=a(!1);var _=a(1);a("");var b=a("");a("");var P=a("");a("");var x=a("");a(""),a(""),a("");var F=a("");const I=a(""),v=a(""),Q=a({facingMode:"environment"});a([{label:"rear camera",constraints:{facingMode:"environment"}},{label:"front camera",constraints:{facingMode:"user"}}]),a([{label:"rear camera",constraints:{facingMode:"environment"}},{label:"front camera",constraints:{facingMode:"user"}}]),a([{text:"nothing (default)",value:void 0},{text:"outline",value:(t,e)=>{for(const l of t){const[o,...d]=l.cornerPoints;e.strokeStyle="red",e.beginPath(),e.moveTo(o.x,o.y);for(const{x:i,y:r}of d)e.lineTo(i,r);e.lineTo(o.x,o.y),e.closePath(),e.stroke()}}},{text:"centered text",value:(t,e)=>{for(const l of t){const{boundingBox:o,rawValue:d}=l,i=o.x+o.width/2,r=o.y+o.height/2,f=Math.max(12,50*o.width/e.canvas.width);e.font=`bold ${f}px sans-serif`,e.textAlign="center",e.lineWidth=3,e.strokeStyle="#35495e",e.strokeText(l.rawValue,i,r),e.fillStyle="#5cb984",e.fillText(d,i,r)}}},{text:"bounding box",value:(t,e)=>{for(const l of t){const{boundingBox:{x:o,y:d,width:i,height:r}}=l;e.lineWidth=2,e.strokeStyle="#007bff",e.strokeRect(o,d,i,r)}}}]);const J=a({text:"nothing (default)",value:void 0}),$=t=>{I.value=t.map(e=>e.rawValue).join(", "),console.log("the result",I.value),p.value=I.value,V()},G=t=>{switch(v.value=`[${t.name}]: `,t.name){case"NotAllowedError":v.value+="you need to grant camera access permission";break;case"NotFoundError":v.value+="no camera on this device";break;case"NotSupportedError":v.value+="secure context required (HTTPS, localhost)";break;case"NotReadableError":v.value+="is the camera already in use?";break;case"OverconstrainedError":v.value+="installed cameras are not suitable";break;case"StreamApiNotSupportedError":v.value+="Stream API is not supported in this browser";break;case"InsecureContextError":v.value+="Camera access is only permitted in secure context. Use HTTPS or localhost rather than HTTP.";break;default:v.value+=t.message}},M=S(()=>n.value*_.value);S(()=>(console.log("amount.value.toFixed(2)",n.value.toFixed(2)),n.value.toFixed(2)));const X=S(()=>(console.log("dollaramount.value.toFixed(2)",M.value.toFixed(2)),M.value.toFixed(2)));function Y(t){h.clearAll(),h.show({title:"Success",message:t,color:"success",icon:"ph:check",closable:!0})}function Z(t){try{navigator.clipboard.writeText(t)}catch(e){console.error("Unable to copy text: ",e)}}function N(t){h.clearAll(),h.show({title:"Error",message:t,color:"danger",icon:"ph:user",closable:!0})}function K(){const t={isValid:!1,message:""};try{if(!n.value)throw"Sorry! enter amount to send";if(!p.value)throw"Sorry! enter receiver's address";t.isValid=!0,t.message="all looks good"}catch(e){t.message=e,t.isValid=!1}return t}async function ee(t,e){const l=new Headers;l.append("Content-Type","application/json");const o=JSON.stringify({encryptedData:t,key:e});console.log("raw war",o),await fetch("https://cyto-node.azurewebsites.net/encryption/decrypt",{method:"POST",headers:l,body:o}).then(i=>i.text()).then(i=>{const r=JSON.parse(i);return console.log("grace",r),console.log("encryptedData.value",r.decryptedData),P.value=r.decryptedData,r.decryptedData}).catch(i=>console.error(i))}const te=async()=>{const t=new Headers;t.append("Content-Type","application/json");const e={method:"GET",headers:t};let l=1;fetch("https://api.coingecko.com/api/v3/simple/price?ids=litecoin&vs_currencies=usd",e).then(o=>o.text()).then(o=>{l=JSON.parse(o).litecoin.usd,_.value=l,console.log("resssp",_.value)}).catch(o=>console.error(o))};async function oe(){w.value=!0;const t=localStorage.getItem("gen_wallet_Name"),e=localStorage.getItem("encrytedDataPhrase");console.log("the guy here again whats up",e);let l;if(e)try{l=await ee(e,b.value)}catch(o){console.error("Error decrypting data:",o);return}try{const o=new Headers;o.append("wallet",t),o.append("encryptedpassphrase",P.value),o.append("Content-Type","application/json"),console.log("wetin dey sup",t,l,P.value);const d=JSON.stringify({toAddress:p.value,amount:n.value,transactionDescription:y.value,reciepientName:p.value,amountIncludeFees:!0});console.log("wetin",d),await fetch("https://liaas20240129020448.azurewebsites.net/api/Litecoin/wallet-transaction-builder",{method:"POST",headers:o,body:d}).then(r=>r.text()).then(r=>{const f=JSON.parse(r);console.log("broadData",f),f.successful?(F=f.data,console.log("broadcast: ",F),Z(f.data),Y("Copied Data"+F+"success"),C()):(console.log(f.message),N(f.message)),n.value=0,p.value=""}).catch(r=>console.error(r))}catch(o){console.error(o)}}async function ae(){if(console.log("Amount val",n.value),console.log("Amount recipientAddress.value",p.value),w.value=!0,n.value===0)N("Input Amount");else if(p.value==="")N("Input Address");else try{const t=K();if(!t.isValid)throw new Error(t.message);console.log("This is sending"),await oe(),w.value=!1}catch(t){console.log("error here",t)}}const O={EMAIL_REQUIRED:"A valid email is required",PASSWORD_REQUIRED:"A password is required"},se=E.object({email:E.string().email(O.EMAIL_REQUIRED),password:E.string().min(1,O.PASSWORD_REQUIRED),trustDevice:E.boolean()}),ne=Ce(se),le=S(()=>({email:"",password:"",trustDevice:!1})),{handleSubmit:re,isSubmitting:st,setFieldError:ce,meta:nt,values:lt,errors:rt,resetForm:ct,setFieldValue:it,setErrors:dt}=De({validationSchema:ne,initialValues:le}),R=re(async t=>{console.log("auth-success",t);try{await new Promise((e,l)=>{t.password!=="password"&&setTimeout(()=>l(new Error("Fake backend validation error")),2e3),setTimeout(e,4e3)}),h.clearAll(),h.show({title:"Success",message:"Welcome back!",color:"success",icon:"ph:user-circle-fill",closable:!0})}catch(e){e.message==="Fake backend validation error"&&ce("password",'Invalid credentials (use "password")');return}window.location.href="/dashboards"});function ie(){if(x.value=localStorage.getItem("wallet_address")||"",console.log("wallet address is here value: ",x.value),x.value==null||x.value=="")window.location.href="/onboarding";else{const e=new URLSearchParams(window.location.search).get("address");e&&(p.value=e)}}xe([n,_],()=>{});async function de(){const t=localStorage.getItem("gen_wallet_Name");await B.walletBalance(t).then(e=>{e.successful?(n.value=e.data,console.log("amounting object",n)):(h.clearAll(),h.show({title:"Error",message:e.message,color:"danger",icon:"user-circle-fill",closable:!0}))})}async function ue(){await de(),console.log("amounting here",n);const t=n.value-.01;a(0),n.value>=.01?(n.value=t,console.log("inside",n.value),console.log("outside",t)):(n.value=0,h.clearAll(),h.show({title:"Insufficient balance",message:"Not enough amount",color:"danger",icon:"ph:check",closable:!0}))}async function me(){try{const t=localStorage.getItem("gen_wallet_Name");await B.walletDetails(t).then(e=>{e.message.includes("Requested wallet does not exist or is not loaded")?B.loadWallet(t).then(l=>{console.log("this is the response of a loaded wallet ",l.message),U()}):U()}).catch(()=>{console.log("catch error")})}catch(t){console.log(t)}}async function U(){ie();const e=await te();return e&&(_.value=e.data.amount),_.value}return Se(async()=>{await me()}),(t,e)=>{const l=fe,o=he,d=ve,i=ge,r=H("BaseButtonGroup"),f=we,q=_e,pe=H("qrcode-stream");return ke(),Ae("div",Be,[s("div",Pe,[s("div",Fe,[s("div",Ie,[s("form",{method:"POST",action:"",onSubmit:e[6]||(e[6]=L((...u)=>g(R)&&g(R)(...u),["prevent"])),class:"me-auto ms-auto mt-4 w-full max-w-md",novalidate:""},[s("div",Ne,[c(l,{as:"h2",size:"3xl",weight:"medium"},{default:m(()=>[k(" Send Funds ")]),_:1}),c(o,{size:"sm",class:"text-muted-400 mb-6"},{default:m(()=>[k(" Enter LTC amount you want to send! ")]),_:1})]),s("div",Me,[s("div",Oe,[s("div",Re,[c(g(j),{name:"Amount"},{default:m(()=>[c(r,{class:"flex items-center"},{default:m(()=>[c(d,{type:"number",label:"Amount",placeholder:"Amount",classes:{input:"h-12",wrapper:"w-96"},icon:"cryptocurrency:ltc",modelValue:g(n),"onUpdate:modelValue":e[0]||(e[0]=u=>A(n)?n.value=u:n=u)},null,8,["modelValue"]),c(i,{color:"muted",class:"mt-6 h-12",onClick:e[1]||(e[1]=u=>ue())},{default:m(()=>[Ue]),_:1})]),_:1})]),_:1}),s("div",qe,[s("div",He,[s("span",Le,Ee(X.value)+" in USD",1)])])]),c(r,{name:"WalletAddress",class:"flex items-center"},{default:m(()=>[c(d,{ref:"addressInput",modelValue:g(p),"onUpdate:modelValue":e[2]||(e[2]=u=>A(p)?p.value=u:p=u),type:"text",label:"Wallet Address",placeholder:"Wallet Address",classes:{input:"h-12",wrapper:"w-96"},icon:"solar:copy-bold"},null,8,["modelValue"]),c(i,{color:"muted",class:"mt-6 h-12",onClick:W},{default:m(()=>[je]),_:1})]),_:1}),c(g(j),{name:"EnterComment"},{default:m(()=>[c(d,{modelValue:g(y),"onUpdate:modelValue":e[3]||(e[3]=u=>A(y)?y.value=u:y=u),type:"text",label:"Enter Comment",placeholder:"Enter Comment",classes:{input:"h-12"}},null,8,["modelValue"])]),_:1})]),s("div",ze,[c(i,{disabled:w.value,loading:w.value,type:"submit",color:"primary",class:"!h-12 w-36",onClick:z},{default:m(()=>[k(" Send ")]),_:1},8,["disabled","loading"])]),c(q,{open:T.value,size:"sm",onClose:C},{header:m(()=>[s("div",We,[s("div",Qe,[Je,c(f,{onClick:C})]),c(d,{label:"Passcode",modelValue:g(b),"onUpdate:modelValue":e[4]||(e[4]=u=>A(b)?b.value=u:b=u),type:"password",class:"",icon:"uil:padlock",shape:"curved",classes:{wrapper:"w-full",input:"!h-12 !ps-12",icon:"!h-12 !w-12"}},null,8,["modelValue"])])]),footer:m(()=>[s("div",Ge,[s("div",Xe,[c(i,{loading:w.value,color:"primary",flavor:"solid",onClick:e[5]||(e[5]=L(u=>ae(),["prevent"]))},{default:m(()=>[k(" Confirm Send ")]),_:1},8,["loading"])])])]),default:m(()=>[$e]),_:1},8,["open"]),c(q,{open:D.value,size:"sm",onClose:V,class:"p-10"},{default:m(()=>[s("div",Ye,[Ze,c(f,{onClick:V})]),Ke,c(pe,{onDetect:$,constraints:Q.value,track:J.value.value,formats:t.selectedBarcodeFormats,onError:G},null,8,["constraints","track","formats"])]),_:1},8,["open"])])],32)])])])])}}});export{Vt as default};
